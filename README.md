# 勤怠システム

画像のような Excel の勤怠表を作成できる Web ベースの勤怠管理システムです。

## 機能

- 📅 **月次勤怠入力**: 日々の出勤・退勤時間を入力
- ⏰ **自動計算**: 勤務時間、実働時間、残業時間を自動計算
- 📊 **Excel 出力**: 月次勤怠表を Excel ファイルで出力
- 💾 **データ保存**: JSON 形式で勤怠データを保存
- 📱 **レスポンシブ**: スマートフォンやタブレットでも使用可能
- ⌨️ **キーボードショートカット**: 効率的な操作

## インストール

1. 必要なパッケージをインストール:

```bash
pip install -r requirements.txt
```

2. アプリケーションを起動:

```bash
python app.py
```

3. ブラウザで `http://localhost:5000` にアクセス

## 使用方法

### 1. 勤怠入力

- ホームページから「勤怠入力」をクリック
- 年月を選択して表示
- 各日の出勤時間・退勤時間を入力
- 休憩時間を設定（デフォルト: 1.0 時間）
- 勤務時間・実働時間・残業時間は自動計算されます

### 2. Excel 出力

- 勤怠入力ページの「Excel 出力」ボタンをクリック
- 月次勤怠表が Excel ファイルでダウンロードされます

### 3. キーボードショートカット

- `Ctrl + S`: データ保存
- `Ctrl + E`: Excel 出力

## ファイル構成

```
highflat/
├── app.py                 # メインアプリケーション
├── requirements.txt       # 依存パッケージ
├── attendance_data.json   # 勤怠データ（自動生成）
├── templates/            # HTMLテンプレート
│   ├── base.html
│   ├── index.html
│   └── attendance.html
└── static/              # 静的ファイル
    ├── css/
    │   └── style.css
    └── js/
        └── script.js
```

## 出力される Excel ファイルの形式

画像のような形式で Excel ファイルが生成されます：

| 日付 | 曜日 | 出勤時間 | 退勤時間 | 勤務時間 | 休憩時間 | 実働時間 | 残業時間 | 備考 |
| ---- | ---- | -------- | -------- | -------- | -------- | -------- | -------- | ---- |
| 1/1  | 月   | 09:00    | 18:00    | 9.0      | 1.0      | 8.0      | 0.0      |      |
| 1/2  | 火   | 09:00    | 19:00    | 10.0     | 1.0      | 9.0      | 1.0      |      |
| ...  | ...  | ...      | ...      | ...      | ...      | ...      | ...      | ...  |
| 合計 |      |          |          |          |          | 160.0    | 15.0     |      |

## 特徴

- **自動計算**: 出勤・退勤時間から勤務時間を自動計算
- **残業管理**: 8 時間を超える勤務を残業時間として計算
- **土日表示**: 土日の行は背景色を変更して表示
- **データ永続化**: 入力したデータは JSON ファイルに保存
- **モダン UI**: Bootstrap 5 を使用した美しいインターフェース

## 技術仕様

- **バックエンド**: Python Flask
- **フロントエンド**: HTML5, CSS3, JavaScript
- **UI フレームワーク**: Bootstrap 5
- **Excel 操作**: openpyxl
- **データ形式**: JSON

## ライセンス

MIT License

## サポート

問題や質問がある場合は、GitHub の Issues ページでお知らせください。
